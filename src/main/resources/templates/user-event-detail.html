<!doctype html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" />
    <meta name="author" content="Codecool" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="/js/postrequest.js"></script>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"
            integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous" />

    <!-- MDL CSS and JS -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"/>
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.green-red.min.css" />
    <script src="https://code.getmdl.io/1.3.0/material.min.js"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
          integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous" />

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous"></script>
    <!--<link rel="stylesheet" type="text/css" href="/css/custom.css" />-->

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>


    <!-- <link rel="stylesheet" type="text/css" href="css/bootstrap-datetimepicker.css"> -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.15.1/moment.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.43/css/bootstrap-datetimepicker.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.43/css/bootstrap-datetimepicker-standalone.css" />
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.43/js/bootstrap-datetimepicker.min.js"></script>

</head>
<body>

    <div class="form-group">
        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" >
            <p>Darab cime</p>
            <p id = "title" th:text="${event.getTitle()}"></p>
            <!--<label class="mdl-textfield__label" for="title" ></label>-->
            <!--<input class="mdl-textfield__input" type="text" id="firstname"  th:value="${event.getTitle()}" name="title"/>-->
        </div>

        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
            <p>Leiras</p>
            <p th:text="${event.getDescription()}"></p>
        </div>

        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
            <p>Helyszin</p>
            <p th:text="${event.getLocation()}"></p>
        </div>

        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
            <p>Kezdes</p>
            <p th:text="${event.getStartDateTime()}"></p>
        </div>

        <div class = "mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
            <p>Vege</p>
            <p th:text="${event.getEndDateTime()}"></p>
        </div>

        <div id="divComment" th:class = "${event.getId()}">
            <p>Korabbi kommentek</p>
            <div  th:each="comment : ${event.getComments()}">
                <tr>
                    <td th:text="${comment.getDescription()}"></td>
                    <td th:text="${comment.getUser().getPosition()}"></td>
                    <td th:text="${comment.getEntryTime()}"></td>

                    <a href="" th:if="${comment.getUser().getPosition()} == ${roleString}"><i class="fa fa-eraser" aria-hidden="true"></i> Komment torlese</a>
                </tr>
            </div>

        </div>

        <form id="addComment">
            <div class = "mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                <input class = "mdl-textfield__input" type="text" rows ="3" id ="comment" name="comment"/>
                <label class = "mdl-textfield__label" for = "comment">Uj Komment</label>
            </div>
            <button  th:name="${roleString}" name="" type="button" id="addCommentButton" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect">Uj Komment</button>
        </form>
        <!--<div class = "mdl-textfield mdl-js-textfield mdl-textfield&#45;&#45;floating-label">-->
        <!--<input class = "mdl-textfield__input" type="text" rows ="3" id ="position" th:value="${user.getPosition()}" name="position"/>-->
        <!--<label class = "mdl-textfield__label" for = "position">Position</label>-->
        <!--</div>-->


    </div>


<!--<div th:each="instance : ${event.getEventhezDolgozok()}">-->
<div>
    <form id="customerForm">
        <tr>
            <p th:text="${roleString}">keyvalue</p>
            <p id="numOfEmployee" th:text="${roleInteger}">num</p>
            <select name="" id="employee">
                <option value="" selected="true" disabled="disabled">Kerlek valassz egyet</option>
                <option th:each="employee : ${employees}"
                        th:if="${employee.getPosition()} == ${roleString}"
                        th:text="${employee.getName()}" th:value="${employee.getId()}"
                ></option>
                <!--th:value="${employee.getId()}"-->
                <!--th:text="#{${'seedstarter.type.' + employee.getId()}}">Wireframe</option>-->
            </select>
            <a href=""></a>
            <button type="submit" id="selectEmployee" ><i class="fa fa-plus" aria-hidden="true"></i> Rendelj Hozza</button>
            <br/>
        </tr>
    </form>

</div>


<div id="postResultDiv">
</div>

    <div class="buttonpara">
        <div th:each="orderedEmployee : ${event.getEmployeesToEvent()}">
            <button th:name="${orderedEmployee.getName()}"
                    th:text="${orderedEmployee.getName()}"
                    class="button"
                    th:id="${orderedEmployee.getId()}">
                nevecske
            </button>
        </div>
    </div>



<script type="text/javascript">
    $(document).ready(function(){

        $(document).on("click",".button",function (){

            var name = $( this ).attr("name");
            var $numOfEmployee = $("#numOfEmployee");
            var newVal = parseInt($numOfEmployee.text());
            newVal = newVal +1;
            $numOfEmployee.text( newVal );
            var eventId = $("#divComment").attr("class");


            var empId = $( this ).attr("id");
            $.post("/restoreEmployee",
                {
                    name: $(this).attr("name"),
//                    "name": $(this).attr("name"),
                    "empId": $(this).attr("id"),
                    "eventId": eventId
                },
                function(response){
//                    alert("Name: " + response);
                });
            $( this ).remove(),


            $('#employee').append(`<option value="${empId}">${name}</option>`)


        });

        $(document).on("click","#addCommentButton",function (){
            var comment = $( "input" ).val();
            var role = $("#addCommentButton").attr("name");
//            var date = new Date();
            var eventId = $("#divComment").attr("class");

            console.log(comment)
            $( "#divComment" ).append( `<div><tr>
                <td>${comment}</td>
                <td>${role}</td>
                </tr>
                </div>` );
            $.post("/addComment",
                {
//                    name: $(this).attr("name"),
                    "comment": comment,
                    "role": role,
                    "eventId": eventId
                },
                function(response){
                    alert("Elmentve a komment: " + response);
                });
        });

        $("#selectEmployee").click(function(){
            debugger;
            var selectedEmployee = $("#employee option:selected");
            var $numOfEmployee = $("#numOfEmployee");
            var newVal = parseInt($numOfEmployee.text() - 1);
            if(newVal !== 0){
                if(selectedEmployee.val() !== ""){
                    $numOfEmployee.text( newVal );
                }

            }else {
                $numOfEmployee.text( "Letszam elerve" );


            }

            if (selectedEmployee.val() !== "") {
                $(".buttonpara").append(`<div><button name = "${selectedEmployee.text()}" class="button" id="${selectedEmployee.val()}">
                                            ${selectedEmployee.text()}
                                         </button></div>`);
            }

        });
    });
</script>
</body>

</html>